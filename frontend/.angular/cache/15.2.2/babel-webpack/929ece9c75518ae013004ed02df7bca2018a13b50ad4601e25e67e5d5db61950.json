{"ast":null,"code":"import { FormControl, Validators } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../_services/auth.service\";\nimport * as i2 from \"../_services/storage.service\";\nfunction LoginComponent_form_3_mat_error_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\", 17);\n    i0.ɵɵtext(1, \" Username is required! \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction LoginComponent_form_3_div_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \"Password is required\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction LoginComponent_form_3_div_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \" Password must be at least 6 characters \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction LoginComponent_form_3_div_20_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 18);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r8 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" Login failed: \", ctx_r8.errorMessage, \" \");\n  }\n}\nconst _c0 = function (a0) {\n  return {\n    \"is-invalid\": a0\n  };\n};\nfunction LoginComponent_form_3_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"form\", 5, 6);\n    i0.ɵɵlistener(\"ngSubmit\", function LoginComponent_form_3_Template_form_ngSubmit_0_listener() {\n      i0.ɵɵrestoreView(_r10);\n      const _r2 = i0.ɵɵreference(1);\n      const ctx_r9 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(_r2.form.valid && ctx_r9.onSubmit());\n    });\n    i0.ɵɵelementStart(2, \"mat-form-field\", 7)(3, \"mat-label\");\n    i0.ɵɵtext(4, \"Username\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"input\", 8, 9);\n    i0.ɵɵlistener(\"ngModelChange\", function LoginComponent_form_3_Template_input_ngModelChange_5_listener($event) {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r11 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r11.form.username = $event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(7, LoginComponent_form_3_mat_error_7_Template, 2, 0, \"mat-error\", 10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"mat-form-field\", 7)(9, \"mat-label\");\n    i0.ɵɵtext(10, \"Password\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"input\", 11, 12);\n    i0.ɵɵlistener(\"ngModelChange\", function LoginComponent_form_3_Template_input_ngModelChange_11_listener($event) {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r12 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r12.form.password = $event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"mat-error\");\n    i0.ɵɵtemplate(14, LoginComponent_form_3_div_14_Template, 2, 0, \"div\", 13);\n    i0.ɵɵtemplate(15, LoginComponent_form_3_div_15_Template, 2, 0, \"div\", 13);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(16, \"div\", 14)(17, \"button\", 15);\n    i0.ɵɵtext(18, \" Login \");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(19, \"div\", 14);\n    i0.ɵɵtemplate(20, LoginComponent_form_3_div_20_Template, 2, 1, \"div\", 16);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const _r2 = i0.ɵɵreference(1);\n    const _r3 = i0.ɵɵreference(6);\n    const _r5 = i0.ɵɵreference(12);\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"hideRequiredMarker\", true);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.form.username)(\"ngClass\", i0.ɵɵpureFunction1(10, _c0, _r2.submitted && _r3.errors));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", _r3.errors && _r2.submitted);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"hideRequiredMarker\", true);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.form.password)(\"ngClass\", i0.ɵɵpureFunction1(12, _c0, _r2.submitted && _r5.errors));\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngIf\", _r5.errors[\"required\"]);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", _r5.errors[\"minlength\"]);\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngIf\", _r2.submitted && ctx_r0.isLoginFailed);\n  }\n}\nfunction LoginComponent_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 19);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" Logged in as \", ctx_r1.roles, \". \");\n  }\n}\nexport class LoginComponent {\n  constructor(authService, storageService) {\n    this.authService = authService;\n    this.storageService = storageService;\n    this.form = {\n      username: null,\n      password: null\n    };\n    this.isLoggedIn = false;\n    this.isLoginFailed = false;\n    this.errorMessage = '';\n    this.roles = [];\n    this.email = new FormControl('', [Validators.required, Validators.email]);\n  }\n  ngOnInit() {\n    if (this.storageService.isLoggedIn()) {\n      this.isLoggedIn = true;\n      this.roles = this.storageService.getUser().roles;\n    }\n  }\n  onSubmit() {\n    const {\n      username,\n      password\n    } = this.form;\n    this.authService.login(username, password).subscribe({\n      next: data => {\n        this.storageService.saveUser(data);\n        this.isLoginFailed = false;\n        this.isLoggedIn = true;\n        this.roles = this.storageService.getUser().roles;\n        this.reloadPage();\n      },\n      error: err => {\n        this.errorMessage = err.error.message;\n        this.isLoginFailed = true;\n      }\n    });\n  }\n  reloadPage() {\n    window.location.reload();\n  }\n}\nLoginComponent.ɵfac = function LoginComponent_Factory(t) {\n  return new (t || LoginComponent)(i0.ɵɵdirectiveInject(i1.AuthService), i0.ɵɵdirectiveInject(i2.StorageService));\n};\nLoginComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: LoginComponent,\n  selectors: [[\"app-login\"]],\n  decls: 5,\n  vars: 2,\n  consts: [[1, \"col-md-12\"], [1, \"card\", \"card-container\"], [\"id\", \"profile-img\", \"src\", \"//ssl.gstatic.com/accounts/ui/avatar_2x.png\", 1, \"profile-img-card\"], [\"name\", \"form\", \"novalidate\", \"\", 3, \"ngSubmit\", 4, \"ngIf\"], [\"class\", \"alert alert-success\", 4, \"ngIf\"], [\"name\", \"form\", \"novalidate\", \"\", 3, \"ngSubmit\"], [\"f\", \"ngForm\"], [3, \"hideRequiredMarker\"], [\"matInput\", \"\", \"type\", \"text\", \"name\", \"username\", \"required\", \"\", 1, \"form-control\", 3, \"ngModel\", \"ngClass\", \"ngModelChange\"], [\"username\", \"ngModel\"], [\"class\", \"invalid-feedback\", 4, \"ngIf\"], [\"matInput\", \"\", \"type\", \"password\", \"name\", \"password\", \"required\", \"\", \"minlength\", \"6\", 1, \"form-control\", 3, \"ngModel\", \"ngClass\", \"ngModelChange\"], [\"password\", \"ngModel\"], [4, \"ngIf\"], [1, \"form-group\"], [\"mat-raised-button\", \"\", 1, \"btn\", \"btn-primary\", \"btn-block\"], [\"class\", \"alert alert-danger\", \"role\", \"alert\", 4, \"ngIf\"], [1, \"invalid-feedback\"], [\"role\", \"alert\", 1, \"alert\", \"alert-danger\"], [1, \"alert\", \"alert-success\"]],\n  template: function LoginComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1);\n      i0.ɵɵelement(2, \"img\", 2);\n      i0.ɵɵtemplate(3, LoginComponent_form_3_Template, 21, 14, \"form\", 3);\n      i0.ɵɵtemplate(4, LoginComponent_div_4_Template, 2, 1, \"div\", 4);\n      i0.ɵɵelementEnd()();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"ngIf\", !ctx.isLoggedIn);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.isLoggedIn);\n    }\n  },\n  styles: [\"var[_ngcontent-%COMP%]   resource[_ngcontent-%COMP%];\\n (()[_ngcontent-%COMP%]   =[_ngcontent-%COMP%] >  { // webpackBootstrap\\n \\tvar __webpack_modules__ = ({\\n\\n 49:\\n\\n (() => {\\n\\nthrow new Error(\\\"Module build failed (from ./node_modules/css-loader/dist/cjs.js):\\\\nError: Can't resolve '~@angular/material/prebuilt-themes/indigo-pink.css' in '/Users/lauraghimici/Documents/Automatica si Informatica Aplicata /MASTER/Anul 1/Sem 1/Proiect-semestru/frontend/src/app/login'\\\\n    at finishWithoutResolve (/Users/lauraghimici/Documents/Automatica si Informatica Aplicata /MASTER/Anul 1/Sem 1/Proiect-semestru/frontend/node_modules/enhanced-resolve/lib/Resolver.js:309:18)\\\\n    at /Users/lauraghimici/Documents/Automatica si Informatica Aplicata /MASTER/Anul 1/Sem 1/Proiect-semestru/frontend/node_modules/enhanced-resolve/lib/Resolver.js:386:15\\\\n    at /Users/lauraghimici/Documents/Automatica si Informatica Aplicata /MASTER/Anul 1/Sem 1/Proiect-semestru/frontend/node_modules/enhanced-resolve/lib/Resolver.js:435:5\\\\n    at eval (eval at create (/Users/lauraghimici/Documents/Automatica si Informatica Aplicata /MASTER/Anul 1/Sem 1/Proiect-semestru/frontend/node_modules/tapable/lib/HookCodeFactory.js:33:10), <anonymous>:16:1)\\\\n    at /Users/lauraghimici/Documents/Automatica si Informatica Aplicata /MASTER/Anul 1/Sem 1/Proiect-semestru/frontend/node_modules/enhanced-resolve/lib/Resolver.js:435:5\\\\n    at eval (eval at create (/Users/lauraghimici/Documents/Automatica si Informatica Aplicata /MASTER/Anul 1/Sem 1/Proiect-semestru/frontend/node_modules/tapable/lib/HookCodeFactory.js:33:10), <anonymous>:27:1)\\\\n    at /Users/lauraghimici/Documents/Automatica si Informatica Aplicata /MASTER/Anul 1/Sem 1/Proiect-semestru/frontend/node_modules/enhanced-resolve/lib/DescriptionFilePlugin.js:87:43\\\\n    at /Users/lauraghimici/Documents/Automatica si Informatica Aplicata /MASTER/Anul 1/Sem 1/Proiect-semestru/frontend/node_modules/enhanced-resolve/lib/Resolver.js:435:5\\\\n    at eval (eval at create (/Users/lauraghimici/Documents/Automatica si Informatica Aplicata /MASTER/Anul 1/Sem 1/Proiect-semestru/frontend/node_modules/tapable/lib/HookCodeFactory.js:33:10), <anonymous>:16:1)\\\\n    at /Users/lauraghimici/Documents/Automatica si Informatica Aplicata /MASTER/Anul 1/Sem 1/Proiect-semestru/frontend/node_modules/enhanced-resolve/lib/Resolver.js:435:5\\\");\\n\\n })\\n\\n \\t});\\n\\n \\t\\n \\t// startup\\n \\t// Load entry module and return exports\\n \\t// This entry module doesn't tell about it's top-level declarations so it can't be inlined\\n \\tvar __webpack_exports__ = {};\\n \\t__webpack_modules__[49]();\\n \\tresource = __webpack_exports__;\\n \\t\\n })()\\n;\\n/*# sourceMappingURL=login.component.css.map*/\"]\n});","map":{"version":3,"mappings":"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","names":["FormControl","Validators","i0","ctx_r9","LoginComponent","constructor","authService","storageService","username","password","required","email","ngOnInit","isLoggedIn","roles","getUser","onSubmit","form","login","subscribe","next","data","saveUser","isLoginFailed","reloadPage","error","err","errorMessage","message","window","location","reload","selectors","decls","vars","consts","template"],"sourceRoot":"","sources":["/Users/lauraghimici/Documents/Automatica si Informatica Aplicata /MASTER/Anul 1/Sem 1/Proiect-semestru/frontend/src/app/login/login.component.ts","/Users/lauraghimici/Documents/Automatica si Informatica Aplicata /MASTER/Anul 1/Sem 1/Proiect-semestru/frontend/src/app/login/login.component.html"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { FormGroup, FormControl, Validators } from '@angular/forms';\nimport { AuthService } from '../_services/auth.service';\nimport { StorageService } from '../_services/storage.service';\n\n@Component({\n  selector: 'app-login',\n  templateUrl: './login.component.html',\n  styleUrls: ['./login.component.css'],\n})\nexport class LoginComponent implements OnInit {\n  form: any = {\n    username: null,\n    password: null,\n  };\n  isLoggedIn = false;\n  isLoginFailed = false;\n  errorMessage = '';\n  roles: string[] = [];\n  email = new FormControl('', [Validators.required, Validators.email]);\n\n  constructor(\n    private authService: AuthService,\n    private storageService: StorageService\n  ) {}\n\n  ngOnInit(): void {\n    if (this.storageService.isLoggedIn()) {\n      this.isLoggedIn = true;\n      this.roles = this.storageService.getUser().roles;\n    }\n  }\n\n  onSubmit(): void {\n    const { username, password } = this.form;\n\n    this.authService.login(username, password).subscribe({\n      next: (data) => {\n        this.storageService.saveUser(data);\n\n        this.isLoginFailed = false;\n        this.isLoggedIn = true;\n        this.roles = this.storageService.getUser().roles;\n        this.reloadPage();\n      },\n      error: (err) => {\n        this.errorMessage = err.error.message;\n        this.isLoginFailed = true;\n      },\n    });\n  }\n\n  reloadPage(): void {\n    window.location.reload();\n  }\n}\n","<div class=\"col-md-12\">\n  <div class=\"card card-container\">\n    <img\n      id=\"profile-img\"\n      src=\"//ssl.gstatic.com/accounts/ui/avatar_2x.png\"\n      class=\"profile-img-card\"\n    />\n    <form\n      *ngIf=\"!isLoggedIn\"\n      name=\"form\"\n      (ngSubmit)=\"f.form.valid && onSubmit()\"\n      #f=\"ngForm\"\n      novalidate\n    >\n      <mat-form-field [hideRequiredMarker]=\"true\">\n        <mat-label>Username</mat-label>\n        <input\n          matInput\n          type=\"text\"\n          class=\"form-control\"\n          name=\"username\"\n          [(ngModel)]=\"form.username\"\n          required\n          #username=\"ngModel\"\n          [ngClass]=\"{ 'is-invalid': f.submitted && username.errors }\"\n        />\n        <mat-error\n          *ngIf=\"username.errors && f.submitted\"\n          class=\"invalid-feedback\"\n        >\n          Username is required!\n        </mat-error>\n      </mat-form-field>\n      <mat-form-field [hideRequiredMarker]=\"true\">\n        <mat-label>Password</mat-label>\n        <input\n          matInput\n          type=\"password\"\n          class=\"form-control\"\n          name=\"password\"\n          [(ngModel)]=\"form.password\"\n          required\n          minlength=\"6\"\n          #password=\"ngModel\"\n          [ngClass]=\"{ 'is-invalid': f.submitted && password.errors }\"\n        />\n        <mat-error>\n          <div *ngIf=\"password.errors['required']\">Password is required</div>\n          <div *ngIf=\"password.errors['minlength']\">\n            Password must be at least 6 characters\n          </div>\n        </mat-error>\n      </mat-form-field>\n      <div class=\"form-group\">\n        <button mat-raised-button class=\"btn btn-primary btn-block\">\n          Login\n        </button>\n      </div>\n      <div class=\"form-group\">\n        <div\n          *ngIf=\"f.submitted && isLoginFailed\"\n          class=\"alert alert-danger\"\n          role=\"alert\"\n        >\n          Login failed: {{ errorMessage }}\n        </div>\n      </div>\n    </form>\n\n    <div class=\"alert alert-success\" *ngIf=\"isLoggedIn\">\n      Logged in as {{ roles }}.\n    </div>\n  </div>\n</div>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}